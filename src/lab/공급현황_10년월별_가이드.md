# 📚 10년 월별 공급현황 분석 가이드

서울 25개 구의 10년간 월별 주택공급 데이터를 분석하는 방법을 단계별로 설명합니다.

---

## 📋 목차

1. [데이터 준비하기](#1-데이터-준비하기)
2. [Jupyter 노트북 열기](#2-jupyter-노트북-열기)
3. [단계별 실행하기](#3-단계별-실행하기)
4. [자주 묻는 질문](#4-자주-묻는-질문)

---

## 1. 데이터 준비하기

### 필요한 데이터 형식

Excel (.xlsx) 또는 CSV (.csv) 파일에 다음 컬럼이 필요합니다:

| 컬럼명 예시 | 설명 | 필수여부 |
|-----------|------|---------|
| `연월` 또는 `날짜` | 2015-01, 202401 등 | ✅ 필수 |
| `시군구` 또는 `지역` | 서울특별시 강남구 등 | ✅ 필수 |
| `공급량` 또는 `세대수` | 숫자 값 | ✅ 필수 |
| `연도` | 2024 등 | ⭕ 선택 |

### 데이터 예시

```csv
연월,시군구,공급량
2015-01,서울특별시 강남구,120
2015-01,서울특별시 서초구,95
2015-02,서울특별시 강남구,110
...
```

---

## 2. Jupyter 노트북 열기

### 방법 1: VSCode에서
1. `src/lab/공급현황.ipynb` 파일 열기
2. 오른쪽 상단 "Run All" 클릭 또는 각 셀 하나씩 실행

### 방법 2: Jupyter Notebook에서
```bash
cd src/lab
jupyter notebook 공급현황.ipynb
```

---

## 3. 단계별 실행하기

### ✅ STEP 1: 라이브러리 불러오기
```python
import pandas as pd
import matplotlib.pyplot as plt
```

**이 단계에서 하는 일:**
- 데이터 분석에 필요한 도구들을 가져옵니다
- matplotlib으로 그래프를 그릴 수 있게 준비합니다

---

### ✅ STEP 2-3: 데이터 파일 불러오기

```python
# 여기에 파일 경로 입력!
파일경로 = "C:/Users/내이름/Documents/공급데이터.xlsx"
```

**해야 할 일:**
1. 본인의 데이터 파일 경로를 복사
2. `파일경로` 변수에 붙여넣기
3. 파일이 없으면 샘플 데이터가 자동 생성됨

**파일 경로 찾는 법:**
- Windows: 파일 우클릭 → 속성 → 경로 복사
- 예: `C:/Users/MyName/Desktop/data.xlsx`

---

### ✅ STEP 4-5: 컬럼 이름 확인 및 설정

노트북을 실행하면 "컬럼 목록"이 출력됩니다:

```
컬럼 목록:
  1. 연월
  2. 시군구
  3. 공급량
```

이 정보를 보고 STEP 5에서 수정:

```python
날짜컬럼 = "연월"      # 👈 본인 데이터의 날짜 컬럼 이름
구컬럼 = "시군구"      # 👈 본인 데이터의 구 컬럼 이름
공급량컬럼 = "공급량"  # 👈 본인 데이터의 공급량 컬럼 이름
```

**예시:**
- 만약 컬럼이 `기준월`, `지역명`, `세대수`라면:
  ```python
  날짜컬럼 = "기준월"
  구컬럼 = "지역명"
  공급량컬럼 = "세대수"
  ```

---

### ✅ STEP 6: 날짜 변환

```python
df[날짜컬럼] = pd.to_datetime(df[날짜컬럼])
```

**이 단계에서 하는 일:**
- "2024-01", "202401" 같은 텍스트를 날짜로 변환
- 자동으로 인식되므로 보통 수정 불필요

**에러가 나면:**
```python
# 형식을 직접 지정
df[날짜컬럼] = pd.to_datetime(df[날짜컬럼], format='%Y%m')  # 202401
df[날짜컬럼] = pd.to_datetime(df[날짜컬럼], format='%Y-%m')  # 2024-01
```

---

### ✅ STEP 7: 서울 25개 구만 필터링

```python
서울데이터 = df[
    df[구컬럼].apply(lambda x: any(구 in str(x) for 구 in 서울구목록))
]
```

**이 단계에서 하는 일:**
- 경기도, 인천 등 서울 외 지역 제거
- 서울 25개 구만 남김

**결과 확인:**
- "필터링 전 데이터: 5000건"
- "필터링 후 데이터: 3000건"
- "포함된 구: 강남구, 서초구, ..."

---

### ✅ STEP 9: 특정 구 데이터 보기

```python
확인할구 = "강남구"  # 👈 보고 싶은 구 입력
```

**이 단계에서 하는 일:**
- 한 개 구의 10년간 월별 데이터 확인
- 데이터가 제대로 있는지 검증

**다른 구 보려면:**
```python
확인할구 = "서초구"  # 강남구 → 서초구로 변경
```

---

### ✅ STEP 10: 월별 추세 그래프

**이 단계에서 하는 일:**
- 선택한 구의 10년간 공급량 변화를 선 그래프로 표시
- 공급량이 증가했는지 감소했는지 한눈에 확인

**그래프 해석:**
- ↗️ 상승: 공급량 증가
- ↘️ 하락: 공급량 감소
- ↔️ 평평: 공급량 일정

---

### ✅ STEP 11: 연도별 합계

**이 단계에서 하는 일:**
- 매년 총 공급량 계산 (서울 전체)
- 막대 그래프로 연도별 비교

**활용:**
- 어느 해에 공급이 많았는지 확인
- 정부 정책 변화 시점 파악

---

### ✅ STEP 12: 구별 10년 총합 순위

**이 단계에서 하는 일:**
- 10년간 가장 많이 공급한 구 TOP 순위
- 강남3구 vs 기타 지역 비교

**예상 결과:**
1. 송파구: 15,000세대
2. 강남구: 12,000세대
3. 강서구: 10,000세대
...

---

### ✅ STEP 13: 여러 구 비교

```python
비교할구들 = ["강남구", "서초구", "송파구", "강동구"]  # 👈 여기 수정
```

**이 단계에서 하는 일:**
- 여러 구의 추세를 한 그래프에 표시
- 구별 공급 패턴 차이 비교

**팁:**
- 강남3구(강남/서초/송파) 비교
- 한강 이북 vs 이남 비교
- 원하는 구들 자유롭게 선택

---

### ✅ STEP 14: 결과 저장

**생성되는 파일:**
1. `서울_구별_공급현황_10년.xlsx`: 전체 원본 데이터
2. `서울_구별_10년_총합.xlsx`: 구별 합계
3. `서울_연도별_공급량.xlsx`: 연도별 합계

**활용:**
- Excel에서 추가 분석
- 보고서에 첨부
- 다른 사람과 공유

---

## 4. 자주 묻는 질문

### Q1. 날짜 형식 에러가 나요

**에러 메시지:**
```
ValueError: time data '202401' does not match format
```

**해결책:**
```python
# STEP 6에서 format 추가
df[날짜컬럼] = pd.to_datetime(df[날짜컬럼], format='%Y%m')
```

**날짜 형식 참고:**
- `2024-01` → `format='%Y-%m'`
- `202401` → `format='%Y%m'`
- `2024/01` → `format='%Y/%m'`

---

### Q2. 서울 구가 제대로 필터링 안 돼요

**확인사항:**
1. 구 이름 형식 확인
   ```python
   print(df[구컬럼].unique())
   ```

2. 구 이름이 다르면 코드 수정
   ```python
   # 예: "강남" (구 빠짐)
   서울구목록 = ["강남", "서초", "송파", ...]
   ```

---

### Q3. 그래프가 안 보여요

**해결책 1:** 맨 위에 추가
```python
%matplotlib inline
```

**해결책 2:** 한글 폰트 확인
```python
# Mac
plt.rcParams['font.family'] = 'AppleGothic'

# Windows
plt.rcParams['font.family'] = 'Malgun Gothic'
```

---

### Q4. 10년치가 아니라 5년치만 있어요

**문제없습니다!**
- 코드는 자동으로 데이터 기간을 인식
- 5년이면 5년치만 분석됨
- STEP 8에서 "총 기간: X년" 확인

---

### Q5. 공급량이 0이거나 누락된 달이 있어요

**처리 방법:**
```python
# 0을 NaN으로 변경
서울데이터[공급량컬럼] = 서울데이터[공급량컬럼].replace(0, pd.NA)

# 누락된 달 제외하고 분석
서울데이터 = 서울데이터.dropna(subset=[공급량컬럼])
```

---

### Q6. 여러 Excel 시트가 있어요

**특정 시트 읽기:**
```python
df = pd.read_excel(파일경로, sheet_name='Sheet2')  # 시트명 지정
df = pd.read_excel(파일경로, sheet_name=1)  # 두 번째 시트 (0부터 시작)
```

---

## 5. 추가 분석 아이디어

### 🎯 계절별 분석
```python
서울데이터['계절'] = 서울데이터['월'].map({
    1: '겨울', 2: '겨울', 3: '봄',
    4: '봄', 5: '봄', 6: '여름',
    7: '여름', 8: '여름', 9: '가을',
    10: '가을', 11: '가을', 12: '겨울'
})

계절별 = 서울데이터.groupby('계절')[공급량컬럼].mean()
```

### 📈 이동평균선 추가
```python
구데이터['이동평균_3개월'] = 구데이터[공급량컬럼].rolling(window=3).mean()

plt.plot(구데이터[날짜컬럼], 구데이터[공급량컬럼], label='실제')
plt.plot(구데이터[날짜컬럼], 구데이터['이동평균_3개월'], label='3개월 이동평균')
```

### 💹 전년 대비 증감률
```python
연도별공급['증감률'] = 연도별공급[공급량컬럼].pct_change() * 100
print(연도별공급)
```

---

## 6. 도움말

### 문제가 해결 안 되면:
1. 에러 메시지 전체를 복사
2. 해당 셀의 코드와 함께 질문
3. 데이터 샘플 5줄 정도 공유

### 추가 학습 자료:
- [Pandas 공식 문서](https://pandas.pydata.org/docs/)
- [Matplotlib 튜토리얼](https://matplotlib.org/stable/tutorials/index.html)

---

**작성일:** 2025-10-29
**버전:** 1.0
